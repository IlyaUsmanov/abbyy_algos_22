Чтобы продать акцию в день j, нам нужно было ее купить в день i <= j, а тогда минимальная стоимость по которой мы ее могли купить - min(a[0], ... a[j]), т.е. ответом при условии продажи в день j будет a[j] - min(a[0], ... a[j]), значит итоговым ответом будет max по j среди всех таких величин, т.о. осталось научиться эффективно считать min(a[0], ... a[j]). Этот минимум на префиксе можно хранить в 1 перемнной, обновляя на каждой итерации
